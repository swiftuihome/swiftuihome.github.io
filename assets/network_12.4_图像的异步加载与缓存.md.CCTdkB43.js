import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.ymCRTBvy.js";const g=JSON.parse('{"title":"å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜","description":"","frontmatter":{},"headers":[],"relativePath":"network/12.4_å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜.md","filePath":"network/12.4_å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜.md"}'),h={name:"network/12.4_å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜.md"};function e(t,s,p,k,r,E){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜" tabindex="-1">å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ <a class="header-anchor" href="#å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜" aria-label="Permalink to &quot;å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜&quot;">â€‹</a></h1><h2 id="å›¾åƒçš„å¼‚æ­¥åŠ è½½" tabindex="-1">å›¾åƒçš„å¼‚æ­¥åŠ è½½ <a class="header-anchor" href="#å›¾åƒçš„å¼‚æ­¥åŠ è½½" aria-label="Permalink to &quot;å›¾åƒçš„å¼‚æ­¥åŠ è½½&quot;">â€‹</a></h2><p>åœ¨ç°ä»£åº”ç”¨ä¸­ï¼Œå›¾åƒçš„å¼‚æ­¥åŠ è½½æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®ã€‚é€šè¿‡å¼‚æ­¥åŠ è½½ï¼Œæ‚¨å¯ä»¥åœ¨åå°ä¸‹è½½å›¾åƒï¼Œè€Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œä»è€Œä¿æŒç•Œé¢çš„æµç•…æ€§ã€‚ä»¥ä¸‹æ˜¯å®ç°å›¾åƒå¼‚æ­¥åŠ è½½çš„æ­¥éª¤ï¼š</p><ol><li><strong>ä½¿ç”¨URLSession</strong>ï¼šæ‚¨å¯ä»¥ä½¿ç”¨<code>URLSession</code>æ¥å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œä¸‹è½½å›¾åƒæ•°æ®ã€‚</li><li><strong>åˆ›å»ºUIImage</strong>ï¼šä¸‹è½½å®Œæˆåï¼Œå°†æ•°æ®è½¬æ¢ä¸º<code>UIImage</code>å¯¹è±¡ã€‚</li><li><strong>æ›´æ–°UI</strong>ï¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–°UIï¼Œä»¥æ˜¾ç¤ºä¸‹è½½çš„å›¾åƒã€‚</li></ol><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com/image.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSession.shared.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataTask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url) { data, response, error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data, error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.imageView.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">image</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> UIImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">task.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">resume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="å›¾åƒç¼“å­˜ç­–ç•¥" tabindex="-1">å›¾åƒç¼“å­˜ç­–ç•¥ <a class="header-anchor" href="#å›¾åƒç¼“å­˜ç­–ç•¥" aria-label="Permalink to &quot;å›¾åƒç¼“å­˜ç­–ç•¥&quot;">â€‹</a></h2><p>ä¸ºäº†æé«˜æ€§èƒ½ï¼Œæ‚¨å¯ä»¥å®ç°å›¾åƒç¼“å­˜ç­–ç•¥ã€‚ç¼“å­˜å¯ä»¥å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼ŒåŠ å¿«å›¾åƒåŠ è½½é€Ÿåº¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ç¼“å­˜ç­–ç•¥ï¼š</p><ul><li><strong>å†…å­˜ç¼“å­˜</strong>ï¼šä½¿ç”¨<code>NSCache</code>æ¥å­˜å‚¨å›¾åƒï¼Œå¿«é€Ÿè®¿é—®ã€‚</li><li><strong>ç£ç›˜ç¼“å­˜</strong>ï¼šå°†å›¾åƒå­˜å‚¨åœ¨è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä»¥ä¾¿åœ¨åº”ç”¨é‡å¯åä»ç„¶å¯ç”¨ã€‚</li></ul><h2 id="ä½¿ç”¨nscache" tabindex="-1">ä½¿ç”¨NSCache <a class="header-anchor" href="#ä½¿ç”¨nscache" aria-label="Permalink to &quot;ä½¿ç”¨NSCache&quot;">â€‹</a></h2><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> imageCache </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSCache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NSString, UIImage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url: URL) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cachedImage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> imageCache.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url.absoluteString </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSString) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.imageView.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">image</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cachedImage</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ä¸‹è½½å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSession.shared.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataTask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url) { data, response, error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        guard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> UIImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: data) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        imageCache.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(image, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url.absoluteString </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSString)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.imageView.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">image</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    task.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">resume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ç»“åˆ" tabindex="-1">å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ç»“åˆ <a class="header-anchor" href="#å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ç»“åˆ" aria-label="Permalink to &quot;å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ç»“åˆ&quot;">â€‹</a></h2><p>ç»“åˆå¼‚æ­¥åŠ è½½å’Œç¼“å­˜ï¼Œå¯ä»¥æ˜¾è‘—æå‡åº”ç”¨çš„æ€§èƒ½ã€‚æ‚¨å¯ä»¥å…ˆæ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ä¸­å­˜åœ¨å›¾åƒï¼Œåˆ™ç›´æ¥ä½¿ç”¨ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿›è¡Œç½‘ç»œè¯·æ±‚å¹¶ç¼“å­˜ç»“æœã€‚</p><h2 id="ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ" tabindex="-1">ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ <a class="header-anchor" href="#ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ" aria-label="Permalink to &quot;ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ&quot;">â€‹</a></h2><ul><li><strong>å ä½å›¾åƒ</strong>ï¼šåœ¨å›¾åƒåŠ è½½è¿‡ç¨‹ä¸­ï¼Œæ˜¾ç¤ºå ä½å›¾åƒï¼Œä»¥æå‡ç”¨æˆ·ä½“éªŒã€‚</li><li><strong>æ¸è¿›å¼åŠ è½½</strong>ï¼šå¯ä»¥å®ç°æ¸è¿›å¼åŠ è½½ï¼Œå…ˆæ˜¾ç¤ºä½åˆ†è¾¨ç‡å›¾åƒï¼Œå†æ›¿æ¢ä¸ºé«˜åˆ†è¾¨ç‡å›¾åƒã€‚</li></ul><h2 id="ç»“è®º" tabindex="-1">ç»“è®º <a class="header-anchor" href="#ç»“è®º" aria-label="Permalink to &quot;ç»“è®º&quot;">â€‹</a></h2><p>é€šè¿‡å®ç°å›¾åƒçš„å¼‚æ­¥åŠ è½½ä¸ç¼“å­˜ï¼Œæ‚¨å¯ä»¥æ˜¾è‘—æå‡åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚ä½¿ç”¨<code>URLSession</code>è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œç»“åˆ<code>NSCache</code>è¿›è¡Œç¼“å­˜ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘åŠ è½½æ—¶é—´å’Œç½‘ç»œæµé‡ã€‚ä¿æŒç•Œé¢çš„æµç•…æ€§ï¼Œè®©ç”¨æˆ·äº«å—æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼ğŸš€</p>`,16)]))}const y=i(h,[["render",e]]);export{g as __pageData,y as default};
