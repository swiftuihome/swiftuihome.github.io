import{_ as i,c as a,o as n,ag as e}from"./chunks/framework.ymCRTBvy.js";const d=JSON.parse('{"title":"æŒæ¡ UIViewControllerRepresentable åè®®","description":"","frontmatter":{},"headers":[],"relativePath":"advanced/12.2_å®ç° UIViewControllerRepresentable åè®®.md","filePath":"advanced/12.2_å®ç° UIViewControllerRepresentable åè®®.md"}'),l={name:"advanced/12.2_å®ç° UIViewControllerRepresentable åè®®.md"};function t(p,s,r,h,k,E){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="æŒæ¡-uiviewcontrollerrepresentable-åè®®" tabindex="-1">æŒæ¡ UIViewControllerRepresentable åè®® <a class="header-anchor" href="#æŒæ¡-uiviewcontrollerrepresentable-åè®®" aria-label="Permalink to &quot;æŒæ¡ UIViewControllerRepresentable åè®®&quot;">â€‹</a></h1><blockquote><p>UIViewControllerRepresentable åè®®æ˜¯ SwiftUI ä¸ UIKit ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢ï¼Œå®ƒå…è®¸ä½ åœ¨ SwiftUI è§†å›¾ä¸­æ— ç¼é›†æˆ UIKit çš„è§†å›¾æ§åˆ¶å™¨ã€‚è¿™ä¸ºä½ æ‰“å¼€äº†æ— é™å¯èƒ½ï¼Œè®©ä½ èƒ½å¤Ÿåˆ©ç”¨ UIKit å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä½¿ç”¨ UIKit ç‹¬æœ‰çš„æ§ä»¶æˆ–é›†æˆç°æœ‰çš„ UIKit ä»£ç åº“ã€‚</p></blockquote><h2 id="åè®®çš„æ ¸å¿ƒè¦æ±‚" tabindex="-1">åè®®çš„æ ¸å¿ƒè¦æ±‚ <a class="header-anchor" href="#åè®®çš„æ ¸å¿ƒè¦æ±‚" aria-label="Permalink to &quot;åè®®çš„æ ¸å¿ƒè¦æ±‚&quot;">â€‹</a></h2><p>è¦å®ç° UIViewControllerRepresentable åè®®ï¼Œä½ éœ€è¦éµå¾ªä»¥ä¸‹ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼š</p><ol><li><p><strong>åˆ›å»º UIViewController</strong>: ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª UIViewController çš„ç±»ï¼Œå¹¶åœ¨è¿™ä¸ªç±»ä¸­å®ç°ä½ æƒ³è¦çš„ UIKit è§†å›¾æ§åˆ¶å™¨çš„åŠŸèƒ½ã€‚</p></li><li><p><strong>å®ç° makeUIViewController(context:) æ–¹æ³•</strong>: è¿™ä¸ªæ–¹æ³•è´Ÿè´£åˆ›å»ºå¹¶è¿”å›ä½ çš„ UIKit è§†å›¾æ§åˆ¶å™¨å®ä¾‹ã€‚è¿™æ˜¯ SwiftUI å¦‚ä½•çŸ¥é“è¦æ˜¾ç¤ºå“ªä¸ª UIKit è§†å›¾æ§åˆ¶å™¨çš„å…³é”®ã€‚</p></li><li><p><strong>å®ç° updateUIViewController(_:context:) æ–¹æ³•</strong>: è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨ SwiftUI è§†å›¾çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°ä½ çš„ UIKit è§†å›¾æ§åˆ¶å™¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ ¹æ® SwiftUI çš„ç»‘å®šå˜é‡æ¥æ›´æ–° UIKit è§†å›¾æ§åˆ¶å™¨çš„å±æ€§ã€‚</p></li></ol><h2 id="å®é™…åº”ç”¨ç¤ºä¾‹-ğŸ’¡" tabindex="-1">å®é™…åº”ç”¨ç¤ºä¾‹ ğŸ’¡ <a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-ğŸ’¡" aria-label="Permalink to &quot;å®é™…åº”ç”¨ç¤ºä¾‹ ğŸ’¡&quot;">â€‹</a></h2><p>å‡è®¾ä½ æƒ³åœ¨ SwiftUI ä¸­ä½¿ç”¨ UIKit çš„ UIImagePickerController æ¥è®©ç”¨æˆ·é€‰æ‹©ç…§ç‰‡ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ImagePicker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UIViewControllerRepresentable </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @Binding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image: UIImage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(\\.presentationMode) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> presentationMode</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> makeUIViewController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: Context) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UIImagePickerController {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> picker </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> UIImagePickerController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        picker.delegate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.coordinator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> picker</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateUIViewController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uiViewController: UIImagePickerController, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: Context) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> makeCoordinator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Coordinator {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Coordinator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Coordinator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NSObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UIImagePickerControllerDelegate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UINavigationControllerDelegate </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parent: ImagePicker</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parent: ImagePicker) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.parent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> imagePickerController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> picker: UIImagePickerController, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">didFinishPickingMediaWithInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> info: [UIImagePickerController.InfoKey : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uiImage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> info[.originalImage] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UIImage {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                parent.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">image</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uiImage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            parent.presentationMode.wrappedValue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dismiss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>ImagePicker</code> ç»“æ„ä½“å®ç°äº† UIViewControllerRepresentable åè®®ï¼Œå¹¶ä½¿ç”¨ UIImagePickerController æ¥è®©ç”¨æˆ·é€‰æ‹©ç…§ç‰‡ã€‚<code>Coordinator</code> ç±»å¤„ç† UIImagePickerController çš„ä»£ç†å›è°ƒï¼Œå¹¶å°†é€‰æ‹©çš„å›¾åƒä¼ é€’å› SwiftUI è§†å›¾ã€‚</p><h2 id="æ·±å…¥ç†è§£-context-ğŸ§" tabindex="-1">æ·±å…¥ç†è§£ Context ğŸ§ <a class="header-anchor" href="#æ·±å…¥ç†è§£-context-ğŸ§" aria-label="Permalink to &quot;æ·±å…¥ç†è§£ Context ğŸ§&quot;">â€‹</a></h2><p>åœ¨ makeUIViewController(context:) å’Œ updateUIViewController(_:context:) æ–¹æ³•ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ª context å‚æ•°ã€‚è¿™ä¸ª context å‚æ•°æä¾›äº†å…³äº SwiftUI ç¯å¢ƒçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>coordinator</strong>: ä½ å¯ä»¥ä½¿ç”¨ coordinator æ¥å¤„ç† UIKit è§†å›¾æ§åˆ¶å™¨çš„ä»£ç†å›è°ƒã€‚</li><li><strong>environment</strong>: ä½ å¯ä»¥è®¿é—® SwiftUI çš„ç¯å¢ƒå€¼ï¼Œä¾‹å¦‚é¢œè‰²æ–¹æ¡ˆæˆ–è®¾å¤‡æ–¹å‘ã€‚</li></ul><h2 id="æ€»ç»“-ğŸ‰" tabindex="-1">æ€»ç»“ ğŸ‰ <a class="header-anchor" href="#æ€»ç»“-ğŸ‰" aria-label="Permalink to &quot;æ€»ç»“ ğŸ‰&quot;">â€‹</a></h2><p>UIViewControllerRepresentable åè®®æ˜¯ SwiftUI ä¸ UIKit äº¤äº’çš„å…³é”®ã€‚é€šè¿‡ç†è§£å¹¶æŒæ¡è¿™ä¸ªåè®®ï¼Œä½ å¯ä»¥å……åˆ†åˆ©ç”¨ UIKit çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¹¶åœ¨ SwiftUI åº”ç”¨ä¸­åˆ›å»ºæ›´ä¸°å¯Œã€æ›´å¼ºå¤§çš„ç”¨æˆ·ç•Œé¢ã€‚è®°ä½ï¼Œå®è·µæ˜¯æœ€å¥½çš„è€å¸ˆï¼å°è¯•ä¸åŒçš„ UIKit è§†å›¾æ§åˆ¶å™¨ï¼Œå¹¶æ¢ç´¢å¦‚ä½•å°†å®ƒä»¬é›†æˆåˆ°ä½ çš„ SwiftUI åº”ç”¨ä¸­ã€‚ä½ ä¼šå‘ç°ï¼Œè¿™ä¸ºä½ æ‰“å¼€äº†ä¸€ä¸ªå……æ»¡å¯èƒ½æ€§çš„æ–°ä¸–ç•Œï¼</p>`,14)]))}const c=i(l,[["render",t]]);export{d as __pageData,c as default};
