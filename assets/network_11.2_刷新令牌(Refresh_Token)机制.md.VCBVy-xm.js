import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.ymCRTBvy.js";const g=JSON.parse('{"title":"åˆ·æ–°ä»¤ç‰Œæœºåˆ¶","description":"","frontmatter":{},"headers":[],"relativePath":"network/11.2_åˆ·æ–°ä»¤ç‰Œ(Refresh_Token)æœºåˆ¶.md","filePath":"network/11.2_åˆ·æ–°ä»¤ç‰Œ(Refresh_Token)æœºåˆ¶.md"}'),h={name:"network/11.2_åˆ·æ–°ä»¤ç‰Œ(Refresh_Token)æœºåˆ¶.md"};function p(e,s,k,t,r,E){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="åˆ·æ–°ä»¤ç‰Œæœºåˆ¶" tabindex="-1">åˆ·æ–°ä»¤ç‰Œæœºåˆ¶ <a class="header-anchor" href="#åˆ·æ–°ä»¤ç‰Œæœºåˆ¶" aria-label="Permalink to &quot;åˆ·æ–°ä»¤ç‰Œæœºåˆ¶&quot;">â€‹</a></h1><p>åœ¨ç°ä»£åº”ç”¨ä¸­ï¼Œå¤„ç†ç”¨æˆ·è®¤è¯å’Œä¼šè¯ç®¡ç†æ˜¯è‡³å…³é‡è¦çš„ã€‚åˆ·æ–°ä»¤ç‰Œæœºåˆ¶å¯ä»¥å¸®åŠ©ä½ åœ¨ç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œè¿‡æœŸæ—¶ï¼Œè‡ªåŠ¨è·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼Œä»è€Œä¿æŒç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯å®ç°åˆ·æ–°ä»¤ç‰Œæœºåˆ¶çš„å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p><h2 id="_1-äº†è§£ä»¤ç‰Œçš„å·¥ä½œåŸç†" tabindex="-1">1. äº†è§£ä»¤ç‰Œçš„å·¥ä½œåŸç† <a class="header-anchor" href="#_1-äº†è§£ä»¤ç‰Œçš„å·¥ä½œåŸç†" aria-label="Permalink to &quot;1. äº†è§£ä»¤ç‰Œçš„å·¥ä½œåŸç†&quot;">â€‹</a></h2><ul><li><strong>è®¿é—®ä»¤ç‰Œ</strong>ï¼šç”¨äºè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œé€šå¸¸æœ‰è¾ƒçŸ­çš„æœ‰æ•ˆæœŸã€‚</li><li><strong>åˆ·æ–°ä»¤ç‰Œ</strong>ï¼šç”¨äºè·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼Œé€šå¸¸æœ‰æ•ˆæœŸè¾ƒé•¿ã€‚</li></ul><h2 id="_2-è®¾è®¡ä»¤ç‰Œå­˜å‚¨" tabindex="-1">2. è®¾è®¡ä»¤ç‰Œå­˜å‚¨ <a class="header-anchor" href="#_2-è®¾è®¡ä»¤ç‰Œå­˜å‚¨" aria-label="Permalink to &quot;2. è®¾è®¡ä»¤ç‰Œå­˜å‚¨&quot;">â€‹</a></h2><p>ä½ éœ€è¦å®‰å…¨åœ°å­˜å‚¨è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li><strong>Keychain</strong>ï¼šåœ¨iOSä¸­ï¼ŒKeychainæ˜¯å­˜å‚¨æ•æ„Ÿä¿¡æ¯çš„å®‰å…¨æ–¹å¼ã€‚</li><li><strong>UserDefaults</strong>ï¼šé€‚åˆå­˜å‚¨éæ•æ„Ÿä¿¡æ¯ï¼Œä½†ä¸æ¨èç”¨äºä»¤ç‰Œã€‚</li></ul><h2 id="_3-å®ç°åˆ·æ–°é€»è¾‘" tabindex="-1">3. å®ç°åˆ·æ–°é€»è¾‘ <a class="header-anchor" href="#_3-å®ç°åˆ·æ–°é€»è¾‘" aria-label="Permalink to &quot;3. å®ç°åˆ·æ–°é€»è¾‘&quot;">â€‹</a></h2><p>å½“è®¿é—®ä»¤ç‰Œè¿‡æœŸæ—¶ï¼Œåº”ç”¨éœ€è¦è‡ªåŠ¨è¯·æ±‚æ–°çš„è®¿é—®ä»¤ç‰Œã€‚ä»¥ä¸‹æ˜¯å®ç°æ­¥éª¤ï¼š</p><ol><li><strong>æ£€æµ‹ä»¤ç‰Œè¿‡æœŸ</strong>ï¼šåœ¨æ¯æ¬¡è¯·æ±‚å‰ï¼Œæ£€æŸ¥è®¿é—®ä»¤ç‰Œæ˜¯å¦è¿‡æœŸã€‚</li><li><strong>å‘é€åˆ·æ–°è¯·æ±‚</strong>ï¼šå¦‚æœè¿‡æœŸï¼Œä½¿ç”¨åˆ·æ–°ä»¤ç‰Œå‘é€è¯·æ±‚ä»¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚</li><li><strong>æ›´æ–°å­˜å‚¨</strong>ï¼šæˆåŠŸè·å–æ–°ä»¤ç‰Œåï¼Œæ›´æ–°å­˜å‚¨ä¸­çš„è®¿é—®ä»¤ç‰Œã€‚</li></ol><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> refreshAccessToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">completion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@escaping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> refreshToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getRefreshToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        completion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.example.com/refresh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URLRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    request.httpMethod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;POST&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    request.httpBody </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;refresh_token=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(refreshToken)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSession.shared.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataTask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: request) { data, response, error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        guard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data, error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            completion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parseToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: data) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            saveAccessToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newToken)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            completion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            completion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    task.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">resume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_4-é”™è¯¯å¤„ç†" tabindex="-1">4. é”™è¯¯å¤„ç† <a class="header-anchor" href="#_4-é”™è¯¯å¤„ç†" aria-label="Permalink to &quot;4. é”™è¯¯å¤„ç†&quot;">â€‹</a></h2><p>åœ¨å®ç°åˆ·æ–°ä»¤ç‰Œæœºåˆ¶æ—¶ï¼Œé”™è¯¯å¤„ç†éå¸¸é‡è¦ã€‚ä½ éœ€è¦è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š</p><ul><li><strong>åˆ·æ–°ä»¤ç‰Œå¤±æ•ˆ</strong>ï¼šå¦‚æœåˆ·æ–°ä»¤ç‰Œä¹Ÿè¿‡æœŸï¼Œç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•ã€‚</li><li><strong>ç½‘ç»œé”™è¯¯</strong>ï¼šå¤„ç†ç½‘ç»œè¯·æ±‚å¤±è´¥çš„æƒ…å†µï¼Œå¯èƒ½éœ€è¦é‡è¯•æˆ–æç¤ºç”¨æˆ·ã€‚</li></ul><h2 id="_5-ç”¨æˆ·ä½“éªŒ" tabindex="-1">5. ç”¨æˆ·ä½“éªŒ <a class="header-anchor" href="#_5-ç”¨æˆ·ä½“éªŒ" aria-label="Permalink to &quot;5. ç”¨æˆ·ä½“éªŒ&quot;">â€‹</a></h2><p>ç¡®ä¿åœ¨ç”¨æˆ·ä½“éªŒä¸Šåšåˆ°æ— ç¼ã€‚å¯ä»¥åœ¨åå°è‡ªåŠ¨å¤„ç†ä»¤ç‰Œåˆ·æ–°ï¼Œé¿å…ç”¨æˆ·æ„ŸçŸ¥åˆ°ä»»ä½•ä¸­æ–­ã€‚ä½¿ç”¨é€‚å½“çš„æç¤ºæˆ–åŠ è½½æŒ‡ç¤ºå™¨æ¥æå‡ç”¨æˆ·ä½“éªŒã€‚</p><p>é€šè¿‡å®ç°åˆ·æ–°ä»¤ç‰Œæœºåˆ¶ï¼Œä½ å¯ä»¥ç¡®ä¿ç”¨æˆ·åœ¨ä½¿ç”¨åº”ç”¨æ—¶ï¼Œèƒ½å¤Ÿäº«å—åˆ°æµç•…çš„ä½“éªŒï¼Œè€Œä¸å¿…é¢‘ç¹åœ°é‡æ–°ç™»å½•ã€‚ä¿æŒç”¨æˆ·çš„ä¼šè¯æ´»è·ƒæ˜¯æå‡ç”¨æˆ·æ»¡æ„åº¦çš„å…³é”®å› ç´ ä¹‹ä¸€ï¼ğŸš€</p>`,17)]))}const y=i(h,[["render",p]]);export{g as __pageData,y as default};
