import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.Bw-5EFTY.js";const c=JSON.parse('{"title":"ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°","description":"","frontmatter":{},"headers":[],"relativePath":"network/7.2_ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°.md","filePath":"network/7.2_ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°.md"}'),p={name:"network/7.2_ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°.md"};function t(h,s,e,k,r,d){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°" tabindex="-1">ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•° <a class="header-anchor" href="#ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°" aria-label="Permalink to &quot;ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°&quot;">â€‹</a></h1><p>åœ¨Swiftä¸­ï¼Œä½¿ç”¨<code>await</code>å…³é”®å­—å¯ä»¥è®©ä½ ä»¥æ›´ç®€æ´çš„æ–¹å¼å¤„ç†å¼‚æ­¥å‡½æ•°ã€‚é€šè¿‡<code>await</code>ï¼Œä½ å¯ä»¥æš‚åœå½“å‰çš„æ‰§è¡Œï¼Œç›´åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œè¿™æ ·å¯ä»¥é¿å…å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œä½¿ä»£ç æ›´åŠ æ¸…æ™°æ˜“è¯»ã€‚</p><h2 id="_1-åŸºæœ¬ç”¨æ³•" tabindex="-1">1. åŸºæœ¬ç”¨æ³• <a class="header-anchor" href="#_1-åŸºæœ¬ç”¨æ³•" aria-label="Permalink to &quot;1. åŸºæœ¬ç”¨æ³•&quot;">â€‹</a></h2><p>å½“ä½ è°ƒç”¨ä¸€ä¸ªæ ‡è®°ä¸º<code>async</code>çš„å‡½æ•°æ—¶ï¼Œå¿…é¡»åœ¨è°ƒç”¨å‰åŠ ä¸Š<code>await</code>ã€‚ä¾‹å¦‚ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> throws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Data {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (data, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSession.shared.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fetchData</code>å‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒä½¿ç”¨<code>await</code>æ¥ç­‰å¾…ç½‘ç»œè¯·æ±‚çš„å®Œæˆã€‚è¿™æ ·ï¼Œä½ å¯ä»¥ç›´æ¥å¤„ç†è¿”å›çš„æ•°æ®ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨å›è°ƒã€‚</p><h2 id="_2-é”™è¯¯å¤„ç†" tabindex="-1">2. é”™è¯¯å¤„ç† <a class="header-anchor" href="#_2-é”™è¯¯å¤„ç†" aria-label="Permalink to &quot;2. é”™è¯¯å¤„ç†&quot;">â€‹</a></h2><p>ä½¿ç”¨<code>await</code>æ—¶ï¼Œé”™è¯¯å¤„ç†ä¹Ÿå˜å¾—æ›´åŠ ç®€å•ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>do-catch</code>è¯­å¥æ¥æ•è·å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚ä¾‹å¦‚ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å‘ç”Ÿé”™è¯¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™ç§æ–¹å¼ä½¿å¾—é”™è¯¯å¤„ç†æ›´åŠ ç›´è§‚ï¼Œé¿å…äº†åµŒå¥—çš„å›è°ƒç»“æ„ã€‚</p><h2 id="_3-åœ¨è§†å›¾ä¸­ä½¿ç”¨" tabindex="-1">3. åœ¨è§†å›¾ä¸­ä½¿ç”¨ <a class="header-anchor" href="#_3-åœ¨è§†å›¾ä¸­ä½¿ç”¨" aria-label="Permalink to &quot;3. åœ¨è§†å›¾ä¸­ä½¿ç”¨&quot;">â€‹</a></h2><p>åœ¨SwiftUIä¸­ï¼Œä½ å¯ä»¥åœ¨è§†å›¾çš„<code>task</code>ä¿®é¥°ç¬¦ä¸­è°ƒç”¨å¼‚æ­¥å‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">View </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data: Data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        VStack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // æ˜¾ç¤ºæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;åŠ è½½ä¸­...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;åŠ è½½æ•°æ®å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>task</code>ä¿®é¥°ç¬¦å…è®¸ä½ åœ¨è§†å›¾åŠ è½½æ—¶å¼‚æ­¥è·å–æ•°æ®ï¼Œå¹¶åœ¨è·å–å®Œæˆåæ›´æ–°UIã€‚</p><h2 id="_4-ç»“åˆå…¶ä»–å¼‚æ­¥æ“ä½œ" tabindex="-1">4. ç»“åˆå…¶ä»–å¼‚æ­¥æ“ä½œ <a class="header-anchor" href="#_4-ç»“åˆå…¶ä»–å¼‚æ­¥æ“ä½œ" aria-label="Permalink to &quot;4. ç»“åˆå…¶ä»–å¼‚æ­¥æ“ä½œ&quot;">â€‹</a></h2><p>ä½ å¯ä»¥å°†å¤šä¸ªå¼‚æ­¥æ“ä½œç»“åˆåœ¨ä¸€èµ·ï¼Œä½¿ç”¨<code>async let</code>æ¥å¹¶è¡Œæ‰§è¡Œã€‚ä¾‹å¦‚ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetchMultipleData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> throws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Data, Data) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> firstData </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> secondData </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (firstData, secondData)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¿™ç§æ–¹å¼å¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºå¤šä¸ªè¯·æ±‚å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ç­‰å¾…ã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>ä½¿ç”¨<code>await</code>è°ƒç”¨å¼‚æ­¥å‡½æ•°ä½¿å¾—Swiftä¸­çš„å¼‚æ­¥ç¼–ç¨‹å˜å¾—æ›´åŠ ç®€å•å’Œç›´è§‚ã€‚é€šè¿‡æ¸…æ™°çš„è¯­æ³•å’Œç»“æ„ï¼Œä½ å¯ä»¥æ›´è½»æ¾åœ°å¤„ç†ç½‘ç»œè¯·æ±‚å’Œå…¶ä»–å¼‚æ­¥æ“ä½œã€‚ğŸ’ªâœ¨</p>`,20)]))}const g=i(p,[["render",t]]);export{c as __pageData,g as default};
