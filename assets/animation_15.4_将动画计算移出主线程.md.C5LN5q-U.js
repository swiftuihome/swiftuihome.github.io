import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.ymCRTBvy.js";const c=JSON.parse('{"title":"15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹","description":"","frontmatter":{},"headers":[],"relativePath":"animation/15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹.md","filePath":"animation/15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹.md"}'),p={name:"animation/15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹.md"};function e(h,s,t,k,r,E){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="_15-4-å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹" tabindex="-1">15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹ <a class="header-anchor" href="#_15-4-å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹" aria-label="Permalink to &quot;15.4_å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹&quot;">â€‹</a></h1><p>åœ¨ SwiftUI ä¸­ï¼Œå°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹æ˜¯ä¼˜åŒ–æ€§èƒ½çš„å…³é”®ä¸€æ­¥ï¼ğŸš€ è¿™æ ·åšå¯ä»¥é˜²æ­¢åŠ¨ç”»é˜»å¡ UI å“åº”ï¼Œç¡®ä¿ä½ çš„åº”ç”¨æµç•…è¿è¡Œã€‚è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹å¦‚ä½•å®ç°å§ï¼</p><h2 id="ä¸ºä»€ä¹ˆè¦ç§»å‡ºä¸»çº¿ç¨‹-ğŸ¤”" tabindex="-1">ä¸ºä»€ä¹ˆè¦ç§»å‡ºä¸»çº¿ç¨‹ï¼ŸğŸ¤” <a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦ç§»å‡ºä¸»çº¿ç¨‹-ğŸ¤”" aria-label="Permalink to &quot;ä¸ºä»€ä¹ˆè¦ç§»å‡ºä¸»çº¿ç¨‹ï¼ŸğŸ¤”&quot;">â€‹</a></h2><p>ä¸»çº¿ç¨‹è´Ÿè´£å¤„ç† UI æ›´æ–°å’Œç”¨æˆ·äº¤äº’ã€‚å¦‚æœåŠ¨ç”»è®¡ç®—å ç”¨è¿‡å¤šä¸»çº¿ç¨‹èµ„æºï¼Œä¼šå¯¼è‡´åº”ç”¨å¡é¡¿ï¼Œç”¨æˆ·ä½“éªŒç›´çº¿ä¸‹é™ã€‚å°†è€—æ—¶çš„åŠ¨ç”»è®¡ç®—ç§»åˆ°åå°çº¿ç¨‹ï¼Œå¯ä»¥é‡Šæ”¾ä¸»çº¿ç¨‹ï¼Œä¿æŒ UI çš„æµç•…æ€§ã€‚æ®ç»Ÿè®¡ï¼Œä¼˜åŒ–ä¸»çº¿ç¨‹å¯ä»¥æå‡åº”ç”¨å“åº”é€Ÿåº¦é«˜è¾¾ 60%ï¼ğŸ‰</p><h2 id="å¦‚ä½•å®ç°-ğŸ› ï¸" tabindex="-1">å¦‚ä½•å®ç°ï¼ŸğŸ› ï¸ <a class="header-anchor" href="#å¦‚ä½•å®ç°-ğŸ› ï¸" aria-label="Permalink to &quot;å¦‚ä½•å®ç°ï¼ŸğŸ› ï¸&quot;">â€‹</a></h2><ol><li><p><strong>ä½¿ç”¨ <code>DispatchQueue</code></strong>: è¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªåå°é˜Ÿåˆ—ï¼Œå°†åŠ¨ç”»è®¡ç®—ä»»åŠ¡æ”¾å…¥å…¶ä¸­ã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DispatchQueue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">qos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: .userInitiated).</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è€—æ—¶çš„åŠ¨ç”»è®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> performExpensiveCalculation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æ›´æ–° UI</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.uiElement.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><code>DispatchQueue.global(qos: .userInitiated)</code>: åˆ›å»ºä¸€ä¸ªå…¨å±€é˜Ÿåˆ—ï¼Œ<code>qos</code> å‚æ•°æŒ‡å®šä¼˜å…ˆçº§ã€‚</li><li><code>async</code>: å¼‚æ­¥æ‰§è¡Œé—­åŒ…ä¸­çš„ä»£ç ã€‚</li><li><code>DispatchQueue.main.async</code>: å°† UI æ›´æ–°æ“ä½œæ”¾å›ä¸»çº¿ç¨‹ã€‚</li></ul></li><li><p><strong>ä½¿ç”¨ <code>Timer</code></strong>: å¦‚æœåŠ¨ç”»éœ€è¦å‘¨æœŸæ€§æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨ <code>Timer</code>ï¼Œä½†åŠ¡å¿…åœ¨åå°çº¿ç¨‹åˆ›å»ºå’Œç®¡ç†å®ƒã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timer: Timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Timer.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scheduledTimer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">withTimeInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">repeats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DispatchQueue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">qos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: .userInitiated).</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // åŠ¨ç”»è®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> calculateNextValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // æ›´æ–° UI</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.animatedValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newValue</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> stopAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">invalidate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li><li><p><strong>ä½¿ç”¨ <code>OperationQueue</code></strong>: å¯¹äºæ›´å¤æ‚çš„ä»»åŠ¡ç®¡ç†ï¼Œ<code>OperationQueue</code> æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä½ å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„ <code>Operation</code>ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> animationQueue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OperationQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">animationQueue.qualityOfService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> .userInitiated</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AnimationOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Operation </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // åŠ¨ç”»è®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> performExpensiveCalculation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // æ›´æ–° UI</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.uiElement.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">animationQueue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">addOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AnimationOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ol><h2 id="æœ€ä½³å®è·µ-ğŸŒŸ" tabindex="-1">æœ€ä½³å®è·µ ğŸŒŸ <a class="header-anchor" href="#æœ€ä½³å®è·µ-ğŸŒŸ" aria-label="Permalink to &quot;æœ€ä½³å®è·µ ğŸŒŸ&quot;">â€‹</a></h2><ul><li><strong>é¿å…åœ¨åå°çº¿ç¨‹ç›´æ¥æ“ä½œ UI</strong>: åªèƒ½åœ¨ä¸»çº¿ç¨‹æ›´æ–° UIã€‚</li><li><strong>ä½¿ç”¨åˆé€‚çš„ <code>qos</code></strong>: æ ¹æ®ä»»åŠ¡çš„é‡è¦æ€§é€‰æ‹©åˆé€‚çš„ä¼˜å…ˆçº§ã€‚</li><li><strong>åŠæ—¶å–æ¶ˆä»»åŠ¡</strong>: å¦‚æœåŠ¨ç”»åœæ­¢ï¼Œç¡®ä¿å–æ¶ˆåå°çº¿ç¨‹çš„ä»»åŠ¡ï¼Œé¿å…èµ„æºæµªè´¹ã€‚</li><li><strong>æµ‹è¯•æ€§èƒ½</strong>: ä½¿ç”¨ Instruments å·¥å…·æ¥åˆ†æåŠ¨ç”»æ€§èƒ½ï¼Œç¡®ä¿ä¼˜åŒ–æ•ˆæœã€‚</li></ul><p>é€šè¿‡å°†åŠ¨ç”»è®¡ç®—ç§»å‡ºä¸»çº¿ç¨‹ï¼Œä½ å¯ä»¥æ˜¾è‘—æå‡ SwiftUI åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼ğŸ’ª è®°ä½ï¼Œæµç•…çš„åŠ¨ç”»æ˜¯ä¼˜ç§€åº”ç”¨çš„å…³é”®ï¼</p>`,9)]))}const g=i(p,[["render",e]]);export{c as __pageData,g as default};
