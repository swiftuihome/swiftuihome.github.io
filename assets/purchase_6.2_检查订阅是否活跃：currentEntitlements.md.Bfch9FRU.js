import{_ as n,c as e,o as t,ag as i}from"./chunks/framework.ymCRTBvy.js";const d=JSON.parse('{"title":"检查订阅是否活跃：currentEntitlements","description":"","frontmatter":{},"headers":[],"relativePath":"purchase/6.2_检查订阅是否活跃：currentEntitlements.md","filePath":"purchase/6.2_检查订阅是否活跃：currentEntitlements.md"}'),a={name:"purchase/6.2_检查订阅是否活跃：currentEntitlements.md"};function l(r,s,p,h,c,o){return t(),e("div",null,s[0]||(s[0]=[i(`<h1 id="检查订阅是否活跃-currententitlements" tabindex="-1">检查订阅是否活跃：currentEntitlements <a class="header-anchor" href="#检查订阅是否活跃-currententitlements" aria-label="Permalink to &quot;检查订阅是否活跃：currentEntitlements&quot;">​</a></h1><p>想知道你的用户是否真的可以访问高级功能吗？🤔 <code>currentEntitlements</code> 就是你的秘密武器！它能告诉你哪些订阅是活跃的，确保只有付费用户才能享受特权。</p><h2 id="什么是-entitlements" tabindex="-1">什么是 Entitlements？ <a class="header-anchor" href="#什么是-entitlements" aria-label="Permalink to &quot;什么是 Entitlements？&quot;">​</a></h2><p>Entitlements 就像一把钥匙🔑，解锁应用内的高级功能或内容。<code>currentEntitlements</code> 则是检查用户是否持有这些钥匙的工具。通过验证 entitlements，你可以确保用户拥有有效的订阅，从而提供相应的服务。</p><h2 id="如何使用-currententitlements" tabindex="-1">如何使用 <code>currentEntitlements</code>？ <a class="header-anchor" href="#如何使用-currententitlements" aria-label="Permalink to &quot;如何使用 \`currentEntitlements\`？&quot;">​</a></h2><p>使用 <code>StoreKit</code> 框架，你可以轻松获取用户的 <code>currentEntitlements</code>。这个过程通常涉及以下步骤：</p><ol><li><strong>获取用户交易历史</strong>：首先，你需要获取用户的购买记录。</li><li><strong>验证交易</strong>：确保交易是合法的，没有被篡改。</li><li><strong>检查 entitlements</strong>：查看用户的 entitlements 列表，判断哪些订阅是活跃的。</li></ol><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 示例代码（伪代码）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> entitlements </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> transaction.currentEntitlements</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> entitlements.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;premium_access&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 用户拥有高级访问权限 🎉</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    unlockPremiumFeatures</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 用户没有高级访问权限 😔</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    showSubscriptionOffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="为什么-currententitlements-很重要" tabindex="-1">为什么 <code>currentEntitlements</code> 很重要？ <a class="header-anchor" href="#为什么-currententitlements-很重要" aria-label="Permalink to &quot;为什么 \`currentEntitlements\` 很重要？&quot;">​</a></h2><ul><li><strong>防止盗版</strong>：确保只有付费用户才能访问高级内容，保护你的收入来源。💰</li><li><strong>提升用户体验</strong>：为付费用户提供无缝体验，增加用户满意度。😊</li><li><strong>数据驱动决策</strong>：通过分析 entitlements 数据，了解用户偏好，优化订阅服务。📈</li></ul><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><ul><li><strong>定期验证</strong>：定期检查用户的 entitlements，确保订阅状态是最新的。</li><li><strong>处理错误</strong>：处理可能出现的错误情况，例如网络问题或验证失败。</li><li><strong>提供清晰的反馈</strong>：向用户明确展示他们的订阅状态，避免困惑。</li></ul><p>通过 <code>currentEntitlements</code>，你可以构建一个安全、可靠且用户友好的订阅系统。加油！💪</p>`,13)]))}const u=n(a,[["render",l]]);export{d as __pageData,u as default};
