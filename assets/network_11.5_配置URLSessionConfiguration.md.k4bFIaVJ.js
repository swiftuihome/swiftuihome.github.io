import{_ as s,c as a,o as n,ag as e}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"配置URLSessionConfiguration","description":"","frontmatter":{},"headers":[],"relativePath":"network/11.5_配置URLSessionConfiguration.md","filePath":"network/11.5_配置URLSessionConfiguration.md"}'),t={name:"network/11.5_配置URLSessionConfiguration.md"};function o(l,i,r,h,p,d){return n(),a("div",null,i[0]||(i[0]=[e(`<h1 id="配置urlsessionconfiguration" tabindex="-1">配置URLSessionConfiguration <a class="header-anchor" href="#配置urlsessionconfiguration" aria-label="Permalink to &quot;配置URLSessionConfiguration&quot;">​</a></h1><h2 id="urlsessionconfiguration的基本概念" tabindex="-1">URLSessionConfiguration的基本概念 <a class="header-anchor" href="#urlsessionconfiguration的基本概念" aria-label="Permalink to &quot;URLSessionConfiguration的基本概念&quot;">​</a></h2><p>在进行网络请求时，<code>URLSessionConfiguration</code> 是一个至关重要的类。它允许你配置网络请求的行为和特性。通过合理的配置，你可以优化网络请求的性能和安全性。</p><h2 id="创建urlsessionconfiguration" tabindex="-1">创建URLSessionConfiguration <a class="header-anchor" href="#创建urlsessionconfiguration" aria-label="Permalink to &quot;创建URLSessionConfiguration&quot;">​</a></h2><p>你可以通过以下方式创建一个默认的配置：</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> configuration </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSessionConfiguration.default</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>此外，还有其他几种配置类型：</p><ol><li><strong>default</strong>: 适用于大多数应用场景。</li><li><strong>ephemeral</strong>: 不会在设备上持久化数据，适合处理敏感信息。</li><li><strong>background</strong>: 适合在后台执行长时间的下载或上传任务。</li></ol><h2 id="配置属性" tabindex="-1">配置属性 <a class="header-anchor" href="#配置属性" aria-label="Permalink to &quot;配置属性&quot;">​</a></h2><p><code>URLSessionConfiguration</code> 提供了多个属性来定制网络请求的行为：</p><ul><li><strong>timeoutIntervalForRequest</strong>: 设置请求的超时时间，单位为秒。</li><li><strong>timeoutIntervalForResource</strong>: 设置资源的超时时间，适用于下载或上传任务。</li><li><strong>httpAdditionalHeaders</strong>: 可以添加额外的HTTP头部信息，例如认证信息。</li></ul><p>例如，设置请求超时时间为30秒：</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">configuration.timeoutIntervalForRequest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="使用自定义的urlsessionconfiguration" tabindex="-1">使用自定义的URLSessionConfiguration <a class="header-anchor" href="#使用自定义的urlsessionconfiguration" aria-label="Permalink to &quot;使用自定义的URLSessionConfiguration&quot;">​</a></h2><p>创建自定义的<code>URLSession</code>实例时，可以将配置传递给它：</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URLSession</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: configuration)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这样，你就可以使用这个会话进行网络请求，所有的配置都会生效。</p><h2 id="其他配置选项" tabindex="-1">其他配置选项 <a class="header-anchor" href="#其他配置选项" aria-label="Permalink to &quot;其他配置选项&quot;">​</a></h2><p>除了基本的属性外，<code>URLSessionConfiguration</code> 还支持以下选项：</p><ul><li><strong>allowsCellularAccess</strong>: 是否允许使用蜂窝网络。</li><li><strong>httpMaximumConnectionsPerHost</strong>: 每个主机的最大连接数，适合高并发请求。</li></ul><p>例如，限制每个主机的最大连接数为5：</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">configuration.httpMaximumConnectionsPerHost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="实际应用示例" tabindex="-1">实际应用示例 <a class="header-anchor" href="#实际应用示例" aria-label="Permalink to &quot;实际应用示例&quot;">​</a></h2><p>在实际应用中，合理配置<code>URLSessionConfiguration</code>可以显著提高网络请求的效率。例如，在处理大量数据时，使用<code>background</code>配置可以确保即使应用被挂起，下载任务也能继续进行。</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> backgroundConfig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSessionConfiguration.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">background</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">withIdentifier</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.example.app.background&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> backgroundSession </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URLSession</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: backgroundConfig)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>通过灵活使用<code>URLSessionConfiguration</code>，你可以根据应用的需求优化网络请求的性能和安全性。无论是设置超时时间，还是选择合适的配置类型，都是提升用户体验的重要步骤。💪✨</p>`,27)]))}const c=s(t,[["render",o]]);export{u as __pageData,c as default};
