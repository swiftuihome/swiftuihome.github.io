import{_ as s,c as a,o as n,ag as e}from"./chunks/framework.ymCRTBvy.js";const E=JSON.parse('{"title":"16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation","description":"","frontmatter":{},"headers":[],"relativePath":"animation/16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation.md","filePath":"animation/16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation.md"}'),l={name:"animation/16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation.md"};function t(p,i,h,k,r,o){return n(),a("div",null,i[0]||(i[0]=[e(`<h1 id="_16-2-åœ¨-nsviewrepresentable-ä¸­ä½¿ç”¨-core-animation" tabindex="-1">16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation <a class="header-anchor" href="#_16-2-åœ¨-nsviewrepresentable-ä¸­ä½¿ç”¨-core-animation" aria-label="Permalink to &quot;16.2_åœ¨ NSViewRepresentable ä¸­ä½¿ç”¨ Core Animation&quot;">â€‹</a></h1><p>è®©æˆ‘ä»¬ä¸€èµ·æ¢ç´¢å¦‚ä½•åœ¨ <code>NSViewRepresentable</code> ä¸­ä½¿ç”¨ Core Animationï¼Œä¸ºä½ çš„ SwiftUI è§†å›¾æ³¨å…¥å¼ºå¤§çš„åŠ¨ç”»æ•ˆæœï¼ğŸš€</p><h2 id="æ‹¥æŠ±-core-animation-çš„åŠ›é‡" tabindex="-1">æ‹¥æŠ± Core Animation çš„åŠ›é‡ <a class="header-anchor" href="#æ‹¥æŠ±-core-animation-çš„åŠ›é‡" aria-label="Permalink to &quot;æ‹¥æŠ± Core Animation çš„åŠ›é‡&quot;">â€‹</a></h2><p>Core Animation æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠ¨ç”»å¼•æ“ï¼Œå®ƒç›´æ¥åœ¨æ¸²æŸ“å±‚å·¥ä½œï¼Œæ€§èƒ½å“è¶Šã€‚åœ¨ SwiftUI ä¸­ï¼Œé€šè¿‡ <code>NSViewRepresentable</code>ï¼Œä½ å¯ä»¥å°† Core Animation çš„èƒ½åŠ›å¸¦å…¥ä½ çš„ Mac åº”ç”¨ã€‚è¿™ä¸ºä½ æä¾›äº†æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚çš„åŠ¨ç”»åœºæ™¯æ—¶ã€‚</p><ul><li><strong>æ€§èƒ½ä¼˜åŠ¿</strong>: Core Animation å…è®¸ç¡¬ä»¶åŠ é€Ÿï¼Œä»è€Œå®ç°æµç•…çš„åŠ¨ç”»æ•ˆæœã€‚</li><li><strong>ç²¾ç»†æ§åˆ¶</strong>: ä½ å¯ä»¥ç²¾ç¡®æ§åˆ¶åŠ¨ç”»çš„å„ä¸ªæ–¹é¢ï¼Œä¾‹å¦‚æ—¶é—´æ›²çº¿ã€å…³é”®å¸§ç­‰ã€‚</li><li><strong>ç°æœ‰ä»£ç é›†æˆ</strong>: è½»æ¾åœ°å°†ç°æœ‰çš„åŸºäº Core Animation çš„ä»£ç é›†æˆåˆ° SwiftUI é¡¹ç›®ä¸­ã€‚</li></ul><h2 id="åˆ›å»ºä½ çš„-nsviewrepresentable" tabindex="-1">åˆ›å»ºä½ çš„ NSViewRepresentable <a class="header-anchor" href="#åˆ›å»ºä½ çš„-nsviewrepresentable" aria-label="Permalink to &quot;åˆ›å»ºä½ çš„ NSViewRepresentable&quot;">â€‹</a></h2><p>é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç¬¦åˆ <code>NSViewRepresentable</code> åè®®çš„ç»“æ„ä½“ã€‚è¿™ä¸ªç»“æ„ä½“è´Ÿè´£åˆ›å»ºå’Œé…ç½® <code>NSView</code>ï¼Œä»¥åŠå¤„ç† SwiftUI å’Œ AppKit ä¹‹é—´çš„äº¤äº’ã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AnimatedView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NSViewRepresentable </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> makeNSView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: Context) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSView {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> view </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NSView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // åœ¨è¿™é‡Œé…ç½®ä½ çš„ Core Animation å›¾å±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> view</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateNSView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nsView: NSView, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: Context) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // åœ¨è¿™é‡Œæ›´æ–°ä½ çš„è§†å›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="é…ç½®-core-animation-å›¾å±‚" tabindex="-1">é…ç½® Core Animation å›¾å±‚ <a class="header-anchor" href="#é…ç½®-core-animation-å›¾å±‚" aria-label="Permalink to &quot;é…ç½® Core Animation å›¾å±‚&quot;">â€‹</a></h2><p>åœ¨ <code>makeNSView</code> æ–¹æ³•ä¸­ï¼Œä½ å¯ä»¥åˆ›å»ºå’Œé…ç½® <code>CALayer</code>ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° <code>NSView</code> çš„å›¾å±‚æ ‘ä¸­ã€‚è¿™ä¸ºä½ æä¾›äº†å®Œå…¨çš„æ§åˆ¶æƒï¼Œå¯ä»¥åˆ›å»ºå„ç§è‡ªå®šä¹‰åŠ¨ç”»ã€‚</p><ol><li>åˆ›å»º <code>CALayer</code> å®ä¾‹ã€‚</li><li>è®¾ç½®å›¾å±‚çš„å±æ€§ï¼Œä¾‹å¦‚ <code>backgroundColor</code>ã€<code>bounds</code> ç­‰ã€‚</li><li>åˆ›å»º <code>CABasicAnimation</code> æˆ– <code>CAKeyframeAnimation</code> å®ä¾‹ï¼Œå¹¶é…ç½®åŠ¨ç”»å±æ€§ã€‚</li><li>å°†åŠ¨ç”»æ·»åŠ åˆ°å›¾å±‚ã€‚</li></ol><p>ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªç®€å•çš„èƒŒæ™¯é¢œè‰²åŠ¨ç”»ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> layer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CALayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layer.backgroundColor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSColor.red.cgColor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layer.bounds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CGRect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">view.layer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> layer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">view.wantsLayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // ç¡®ä¿è§†å›¾ä½¿ç”¨å›¾å±‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> animation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CABasicAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">keyPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;backgroundColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">animation.toValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NSColor.blue.cgColor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">animation.duration </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">animation.repeatCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">infinity</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layer.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(animation, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;backgroundColorAnimation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="swiftui-ä¸-core-animation-çš„æ¡¥æ¢-ğŸŒ‰" tabindex="-1">SwiftUI ä¸ Core Animation çš„æ¡¥æ¢ ğŸŒ‰ <a class="header-anchor" href="#swiftui-ä¸-core-animation-çš„æ¡¥æ¢-ğŸŒ‰" aria-label="Permalink to &quot;SwiftUI ä¸ Core Animation çš„æ¡¥æ¢ ğŸŒ‰&quot;">â€‹</a></h2><p><code>NSViewRepresentable</code> å……å½“äº† SwiftUI å’Œ Core Animation ä¹‹é—´çš„æ¡¥æ¢ã€‚é€šè¿‡ <code>updateNSView</code> æ–¹æ³•ï¼Œä½ å¯ä»¥å“åº” SwiftUI çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–° Core Animation å›¾å±‚ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥åˆ›å»ºåŠ¨æ€çš„ã€å“åº”å¼çš„åŠ¨ç”»æ•ˆæœã€‚</p><ul><li>ä½¿ç”¨ <code>@Binding</code> å±æ€§æ¥æ¥æ”¶ SwiftUI çš„çŠ¶æ€ã€‚</li><li>åœ¨ <code>updateNSView</code> ä¸­ï¼Œæ ¹æ®çŠ¶æ€å˜åŒ–æ›´æ–°å›¾å±‚çš„å±æ€§æˆ–åŠ¨ç”»ã€‚</li><li>ç¡®ä¿åœ¨ä¸»çº¿ç¨‹ä¸Šæ›´æ–° UIï¼Œä»¥é¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li></ul><p>ç°åœ¨ï¼Œä½ å·²ç»æŒæ¡äº†åœ¨ <code>NSViewRepresentable</code> ä¸­ä½¿ç”¨ Core Animation çš„åŸºæœ¬æŠ€å·§ã€‚å°½æƒ…å‘æŒ¥ä½ çš„åˆ›é€ åŠ›ï¼Œä¸ºä½ çš„ SwiftUI åº”ç”¨æ·»åŠ ä»¤äººæƒŠè‰³çš„åŠ¨ç”»æ•ˆæœå§ï¼ğŸ‰</p>`,17)]))}const c=s(l,[["render",t]]);export{E as __pageData,c as default};
