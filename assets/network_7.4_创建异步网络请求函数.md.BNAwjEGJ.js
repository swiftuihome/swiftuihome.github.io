import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.ymCRTBvy.js";const c=JSON.parse('{"title":"åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°","description":"","frontmatter":{},"headers":[],"relativePath":"network/7.4_åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°.md","filePath":"network/7.4_åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°.md"}'),p={name:"network/7.4_åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°.md"};function h(t,s,e,k,r,E){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°" tabindex="-1">åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•° <a class="header-anchor" href="#åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°" aria-label="Permalink to &quot;åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°&quot;">â€‹</a></h1><p>åœ¨Swiftä¸­ï¼Œåˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°æ˜¯å®ç°é«˜æ•ˆç½‘ç»œäº¤äº’çš„å…³é”®ã€‚ä½¿ç”¨<code>async/await</code>è¯­æ³•å¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚ä»¥ä¸‹æ˜¯åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°çš„æ­¥éª¤å’Œç¤ºä¾‹ã€‚</p><h2 id="_1-å®šä¹‰å¼‚æ­¥å‡½æ•°" tabindex="-1">1. å®šä¹‰å¼‚æ­¥å‡½æ•° <a class="header-anchor" href="#_1-å®šä¹‰å¼‚æ­¥å‡½æ•°" aria-label="Permalink to &quot;1. å®šä¹‰å¼‚æ­¥å‡½æ•°&quot;">â€‹</a></h2><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚ä½¿ç”¨<code>async</code>å…³é”®å­—æ¥æ ‡è®°è¯¥å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url: URL) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> throws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Data {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (data, response) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> URLSession.shared.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> httpResponse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HTTPURLResponse, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">299</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(httpResponse.statusCode) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        throw</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URLError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(.badServerResponse)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_2-ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°" tabindex="-1">2. ä½¿ç”¨<code>await</code>è°ƒç”¨å¼‚æ­¥å‡½æ•° <a class="header-anchor" href="#_2-ä½¿ç”¨awaitè°ƒç”¨å¼‚æ­¥å‡½æ•°" aria-label="Permalink to &quot;2. ä½¿ç”¨\`await\`è°ƒç”¨å¼‚æ­¥å‡½æ•°&quot;">â€‹</a></h2><p>åœ¨è°ƒç”¨å¼‚æ­¥å‡½æ•°æ—¶ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<code>await</code>å…³é”®å­—ã€‚è¿™å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ç­‰å¾…ç»“æœæ—¶å¯ä»¥æš‚åœå½“å‰ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•è°ƒç”¨ä¸Šé¢å®šä¹‰çš„<code>fetchData</code>å‡½æ•°ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.example.com/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> try</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å¤„ç†æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç½‘ç»œè¯·æ±‚å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\\(error)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_3-å¤„ç†é”™è¯¯" tabindex="-1">3. å¤„ç†é”™è¯¯ <a class="header-anchor" href="#_3-å¤„ç†é”™è¯¯" aria-label="Permalink to &quot;3. å¤„ç†é”™è¯¯&quot;">â€‹</a></h2><p>åœ¨å¼‚æ­¥ç½‘ç»œè¯·æ±‚ä¸­ï¼Œé”™è¯¯å¤„ç†æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½¿ç”¨<code>do-catch</code>è¯­å¥å¯ä»¥æ•è·å¹¶å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚ä¸Šé¢çš„ç¤ºä¾‹ä¸­å·²ç»å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>do-catch</code>æ¥å¤„ç†é”™è¯¯ã€‚</p><h2 id="_4-åœ¨swiftuiä¸­ä½¿ç”¨å¼‚æ­¥å‡½æ•°" tabindex="-1">4. åœ¨SwiftUIä¸­ä½¿ç”¨å¼‚æ­¥å‡½æ•° <a class="header-anchor" href="#_4-åœ¨swiftuiä¸­ä½¿ç”¨å¼‚æ­¥å‡½æ•°" aria-label="Permalink to &quot;4. åœ¨SwiftUIä¸­ä½¿ç”¨å¼‚æ­¥å‡½æ•°&quot;">â€‹</a></h2><p>åœ¨SwiftUIä¸­ï¼Œæ‚¨å¯ä»¥åœ¨è§†å›¾ä¸­ä½¿ç”¨å¼‚æ­¥å‡½æ•°ã€‚é€šè¿‡<code>.task</code>ä¿®é¥°ç¬¦ï¼Œæ‚¨å¯ä»¥åœ¨è§†å›¾åŠ è½½æ—¶è‡ªåŠ¨è°ƒç”¨å¼‚æ­¥å‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">View </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data: Data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        VStack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // æ˜¾ç¤ºæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;åŠ è½½ä¸­...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loadData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_5-æ€»ç»“" tabindex="-1">5. æ€»ç»“ <a class="header-anchor" href="#_5-æ€»ç»“" aria-label="Permalink to &quot;5. æ€»ç»“&quot;">â€‹</a></h2><p>é€šè¿‡ä½¿ç”¨<code>async/await</code>ï¼Œæ‚¨å¯ä»¥è½»æ¾åˆ›å»ºå¼‚æ­¥ç½‘ç»œè¯·æ±‚å‡½æ•°ï¼Œä½¿ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚è®°å¾—åœ¨è°ƒç”¨å¼‚æ­¥å‡½æ•°æ—¶ä½¿ç”¨<code>await</code>ï¼Œå¹¶å¦¥å–„å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚è¿™æ ·ï¼Œæ‚¨å°±èƒ½åœ¨SwiftUIåº”ç”¨ä¸­å®ç°é«˜æ•ˆçš„ç½‘ç»œè¯·æ±‚ï¼ğŸš€</p>`,15)]))}const g=i(p,[["render",h]]);export{c as __pageData,g as default};
