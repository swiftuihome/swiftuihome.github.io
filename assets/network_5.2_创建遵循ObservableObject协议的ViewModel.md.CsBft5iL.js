import{_ as i,c as a,o as n,ag as e}from"./chunks/framework.ymCRTBvy.js";const c=JSON.parse('{"title":"åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel","description":"","frontmatter":{},"headers":[],"relativePath":"network/5.2_åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel.md","filePath":"network/5.2_åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel.md"}'),l={name:"network/5.2_åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel.md"};function p(t,s,h,k,r,d){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="åˆ›å»ºéµå¾ªobservableobjectåè®®çš„viewmodel" tabindex="-1">åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel <a class="header-anchor" href="#åˆ›å»ºéµå¾ªobservableobjectåè®®çš„viewmodel" aria-label="Permalink to &quot;åˆ›å»ºéµå¾ªObservableObjectåè®®çš„ViewModel&quot;">â€‹</a></h1><p>åœ¨SwiftUIä¸­ï¼Œåˆ›å»ºä¸€ä¸ªéµå¾ª<code>ObservableObject</code>åè®®çš„ViewModelæ˜¯å®ç°æ•°æ®é©±åŠ¨è§†å›¾çš„å…³é”®æ­¥éª¤ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°ç®¡ç†å’Œæ›´æ–°è§†å›¾çŠ¶æ€ã€‚</p><h2 id="_1-å®šä¹‰viewmodel" tabindex="-1">1. å®šä¹‰ViewModel <a class="header-anchor" href="#_1-å®šä¹‰viewmodel" aria-label="Permalink to &quot;1. å®šä¹‰ViewModel&quot;">â€‹</a></h2><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œå¹¶ä½¿å…¶éµå¾ª<code>ObservableObject</code>åè®®ã€‚è¿™ä¸ªç±»å°†åŒ…å«æ‚¨æƒ³è¦åœ¨è§†å›¾ä¸­æ˜¾ç¤ºçš„æ•°æ®ã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SwiftUI</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Combine</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ObservableObject </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @Published</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;åˆå§‹æ•°æ®&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newData</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>@Published</code>å±æ€§åŒ…è£…å™¨ç”¨äºæ ‡è®°<code>data</code>å±æ€§ã€‚å½“<code>data</code>çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰è®¢é˜…è¯¥ViewModelçš„è§†å›¾éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ã€‚</p><h2 id="_2-åˆ›å»ºview" tabindex="-1">2. åˆ›å»ºView <a class="header-anchor" href="#_2-åˆ›å»ºview" aria-label="Permalink to &quot;2. åˆ›å»ºView&quot;">â€‹</a></h2><p>æ¥ä¸‹æ¥ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªSwiftUIè§†å›¾ï¼Œå¹¶åœ¨å…¶ä¸­ä½¿ç”¨è¿™ä¸ªViewModelã€‚ä½¿ç”¨<code>@StateObject</code>æ¥åˆå§‹åŒ–ViewModelã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">View </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    @StateObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewModel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MyViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        VStack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(viewModel.data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">font</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(.largeTitle)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">padding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ›´æ–°æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                viewModel.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">updateData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">newData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ›´æ–°åçš„æ•°æ®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>åœ¨è¿™ä¸ªè§†å›¾ä¸­ï¼Œ<code>Text</code>ç»„ä»¶ä¼šæ˜¾ç¤ºViewModelä¸­çš„<code>data</code>å±æ€§ã€‚ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ<code>updateData</code>æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œä»è€Œæ›´æ–°<code>data</code>çš„å€¼ã€‚</p><h2 id="_3-è§‚å¯Ÿæ•°æ®å˜åŒ–" tabindex="-1">3. è§‚å¯Ÿæ•°æ®å˜åŒ– <a class="header-anchor" href="#_3-è§‚å¯Ÿæ•°æ®å˜åŒ–" aria-label="Permalink to &quot;3. è§‚å¯Ÿæ•°æ®å˜åŒ–&quot;">â€‹</a></h2><p>å½“æ‚¨ä½¿ç”¨<code>@StateObject</code>æ—¶ï¼ŒSwiftUIä¼šè‡ªåŠ¨è§‚å¯ŸViewModelçš„å˜åŒ–ã€‚æ¯å½“<code>data</code>æ›´æ–°æ—¶ï¼Œè§†å›¾ä¼šé‡æ–°æ¸²æŸ“ï¼Œç¡®ä¿ç”¨æˆ·çœ‹åˆ°æœ€æ–°çš„ä¿¡æ¯ã€‚</p><h2 id="_4-ç»“åˆå…¶ä»–åŠŸèƒ½" tabindex="-1">4. ç»“åˆå…¶ä»–åŠŸèƒ½ <a class="header-anchor" href="#_4-ç»“åˆå…¶ä»–åŠŸèƒ½" aria-label="Permalink to &quot;4. ç»“åˆå…¶ä»–åŠŸèƒ½&quot;">â€‹</a></h2><p>æ‚¨å¯ä»¥å°†ViewModelä¸å…¶ä»–åŠŸèƒ½ç»“åˆä½¿ç”¨ï¼Œä¾‹å¦‚ç½‘ç»œè¯·æ±‚æˆ–æœ¬åœ°æ•°æ®å­˜å‚¨ã€‚é€šè¿‡å°†è¿™äº›åŠŸèƒ½å°è£…åœ¨ViewModelä¸­ï¼Œæ‚¨å¯ä»¥ä¿æŒè§†å›¾çš„ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><div class="language-swift vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">swift</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DispatchQueue.main.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">asyncAfter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">deadline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ä»ç½‘ç»œè·å–çš„æ•°æ®&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>fetchData</code>æ–¹æ³•æ¨¡æ‹Ÿäº†ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæ‚¨å¯ä»¥åœ¨è§†å›¾çš„<code>onAppear</code>ä¿®é¥°ç¬¦ä¸­è°ƒç”¨å®ƒã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>é€šè¿‡åˆ›å»ºéµå¾ª<code>ObservableObject</code>åè®®çš„ViewModelï¼Œæ‚¨å¯ä»¥æœ‰æ•ˆåœ°ç®¡ç†SwiftUIåº”ç”¨ä¸­çš„çŠ¶æ€ã€‚ä½¿ç”¨<code>@Published</code>å’Œ<code>@StateObject</code>ï¼Œæ‚¨å¯ä»¥ç¡®ä¿è§†å›¾ä¸æ•°æ®ä¿æŒåŒæ­¥ã€‚è¿™æ ·ï¼Œæ‚¨å°±èƒ½æ„å»ºå‡ºå“åº”è¿…é€Ÿä¸”ç”¨æˆ·å‹å¥½çš„åº”ç”¨ç¨‹åºã€‚ç»§ç»­æ¢ç´¢SwiftUIçš„å¼ºå¤§åŠŸèƒ½ï¼Œæ‚¨ä¼šå‘ç°æ›´å¤šçš„å¯èƒ½æ€§ï¼ğŸš€</p>`,18)]))}const o=i(l,[["render",p]]);export{c as __pageData,o as default};
